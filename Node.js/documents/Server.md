# 서버
[4.1 요청과 응답](#41-요청과-응답)  
[-- 4.1.1 서버와 클라이언트](#411-서버와-클라이언트)  
[-- 4.1.2 localhost와 포트](#412-localhost와-포트)  
[4.2 REST API](#42-rest-api)  
[-- 4.2.1 REST API(Representational State Transfer)](#421-rest-apirepresentational-state-transfer)  
[-- 4.2.2 HTTP 프로토콜](#422-http-프로토콜)  
[4.3 쿠키와 세션](#43-쿠키와-세션)  
[-- 4.3.1 쿠키의 필요성](#431-쿠키의-필요성)  
[4.4 https와 http2](#44-https와-http2)  
[-- 4.4.1 https](#441-https)  
[-- 4.4.2 https 서버](#442-https-서버)  
[-- 4.4.3 http2](#443)  
[4.5 클러스터(cluster)](#45-클러스터cluster)  
[-- 4.5.1 cluster](#451-cluster)  

# 4.1 요청과 응답

## 4.1.1 서버와 클라이언트

### 서버와 클라이언트의 관계

- 클라이언트가 서버로 요청(request)을 보냄
- 서버는 요청을 처리
- 처리 후 클라이언트로 응답(response)을 보냄

## 4.1.2 localhost와 포트

### [localhost](http://localhost) 는 컴퓨터 내부 주소

- 외부에서는 접근 불가능

### 포트는 서버 내에서 프로세스를 구분하는 번호

- 기본적으로 http 서버는 80번 포트 사용
- 다른 포트로 데이터베이스나 다른 서버 동시에 연결 가능

# 4.2 REST API

## 4.2.1 REST API(Representational State Transfer)

### REST API(Representational State Transfer)

- 서버의 자원을 정의하고 자원에 대한 주소를 지정하는 방법
- /post 면 게시글에 관련된 자원을 요청하는 행위

### HTTP 요청 메서드

- GET: 서버 자원 가져오기
- POST: 서버에 자원을 새로 등록하고자 할 때 사용(또는 뭘 써야할 지 애매할 때)
- PUT: 서버의 자원을요청에 들어있는 자원으로 치환하고자할 때 사용
- PATCH: 서버 자원의 일부만 수정
- DELETE: 서버 자원을 삭제

## 4.2.2 HTTP 프로토콜

### 클라이언트가 누구든 서버와 HTTP 프로토콜로 소통 가능

- iOS, 안드로이드, 웹이 모두 같은 주소로 요청 보낼 수 있음
- 서버와 클라이언트의 분리

### RESTful

- REST API를 사용한 주소 체계를 이용하는 서버
- GET /user 는 사용자를 조회하는 요청, POST /user 는 사용자를 등록하는 요청

# 4.3 쿠키와 세션

## 4.3.1 쿠키의 필요성

### 요청에는 한 가지 단점이 있음

- 누가 요청을 보냈는지 모름(IP 주소와 브라우저 정보 정도만 알 수 있음)
- 로그인을 구현하면 됨
- 쿠키와 세션이 필요

### 쿠키: 키=값의 쌍

- name = otw
- 매 요청마다 서버에 동봉해서 보냄
- 서버는 쿠키를 읽어 누구인지 파악

4.3.2 세션 사용

쿠키의 정보는 노출되고 수정되는 위험이 있음

- 중요한 정보는 서버에서 관리하고 클라이언트에서는 세션 키만 제공
- 서버에 세션 객체(session) 생성 후, uniqueInt(키)를 만들어 속성명으로 사용
- 속성 값에 정보를 저장하고 uniqueInt(키)를 클라이언트에 보냄

# 4.4 https와 http2

## 4.4.1 https

### 웹 서버에 SSL 암호화를 추가하는 모듈

- 오고 가는 데이터를 암호화해서 중간에 다른 사람이 요청을 가로채더라도 내용을 확인할 수 없음
- 요즘에는 https 적용이 필수(개인 정보가 있는 곳은 특히)

## 4.4.2 https 서버

### http 서버를 https 서버로

- 암호화를 위해 인증서가 필요한데 발급받아야 함

### createServer가 인자를 두 개 받음

- 첫 번째 인자는 인증서와 관련된 옵션 객체
- pem, crt, key 등 인증서를 구입할 때 얻을 수 있는 파일 넣기
- 두 번째 인자는 서버 로직

## 4.4.3 http2

### SSL 암호화와 더불어 최신 HTTP 프로토콜인 http/2를 사용하는 모듈

- 요청 및 응답 방식이 기존 http/1.1보다 개선됨
- 웹의 속도도 개선됨

# 4.5 클러스터(cluster)

## 4.5.1 cluster

### 기본적으로 싱글 스레드인 노드가 CPU 코어를 모두 사용할 수 있게 해주는 모듈

- 포트를 공유하는 노드 프로세스를 여러 개 둘 수 있음
- 요청이 많이 들어왔을 때 병렬로 실행된 서버의 개수만큼 요청이 분산됨
- 서버에 무리가 덜 감
- 코어가 8개인 서버가 있을 때: 보통은 코어 하나만 활용
- cluster로 코어 하나당 노드 프로세스 하나를 배정 가능
- 성능이 8배가 되는 것은 아니지만 개선됨
- 단점: 컴퓨터 자원(메모리, 세션 등) 공유 못 함
- Redis 등 별도 서버로 해결